import{useLayoutEffect as t,useEffect as n,createContext as e,useContext as o,useRef as i,Suspense as a,useMemo as r,useState as u,Fragment as s}from"react";import d from"zustand/vanilla";import f from"zustand";import{CSSTransition as E,TransitionGroup as c,SwitchTransition as g}from"react-transition-group";import{jsx as S}from"react/jsx-runtime";var l;!function(t){t.SUSPENDED="suspended",t.APPEAR="appear",t.APPEARING="appearing",t.APPEARED="appeared",t.EXIT="exit",t.EXITING="exiting",t.EXITED="exited",t.ENTER="enter",t.ENTERING="entering",t.ENTERED="entered"}(l||(l={}));var m=d(function(t){return{transitionStateTo:l.SUSPENDED,transitionStateFrom:l.SUSPENDED,transitionConfig:null,exitDone:function(){},enterDone:function(){},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:function(){return t(function(t){var n;return{data:null==(n=t.transitionConfig)?void 0:n.data,transitionConfig:null}})},suspendedRoute:null}}),p=f(m),x="undefined"!=typeof window?t:n,v=/*#__PURE__*/e("both");function N(t){var e=void 0===t?{}:t,i=e.onEnter,a=e.onEntering,r=e.onEntered,u=e.onExit,s=e.onExiting,d=o(v),f=p(function(t){return t.transitionStateTo}),E=p(function(t){return t.transitionStateFrom}),c=p(function(t){return t.enterDone}),g=p(function(t){return t.exitDone}),S=p(function(t){return t.from}),l=p(function(t){return t.to}),N=p(function(t){return t.data}),T=d===m.getState().to,h=d===m.getState().from;return x(function(){return T&&a&&m.setState({onEnteringCount:m.getState().onEnteringCount+1}),function(){T&&a&&m.setState({onEnteringCount:m.getState().onEnteringCount-1})}},[T,a]),x(function(){return h&&s&&m.setState({onExitingCount:m.getState().onExitingCount+1}),function(){h&&s&&m.setState({onExitingCount:m.getState().onExitingCount-1})}},[h,s]),n(function(){T&&("appear"===f?null==i||i({isAppearing:!0,from:m.getState().from,to:m.getState().to}):"appearing"===f?null==a||a({isAppearing:!0,done:c,from:m.getState().from,to:m.getState().to}):"appeared"===f?null==r||r({isAppearing:!0,from:m.getState().from,to:m.getState().to}):"enter"===f?null==i||i({isAppearing:!1,from:m.getState().from,to:m.getState().to}):"entering"===f?null==a||a({isAppearing:!1,from:m.getState().from,to:m.getState().to,done:c,data:m.getState().data}):"entered"===f&&(null==r||r({isAppearing:!1,from:m.getState().from,to:m.getState().to})))},[f]),x(function(){h&&("exit"===E?null==u||u({to:m.getState().to}):"exiting"===E&&(null==s||s({from:m.getState().from,to:m.getState().to,done:g,data:m.getState().data})))},[E]),"both"===d?{transitionStateTo:f,transitionStateFrom:E,from:S,to:l,data:N}:{transitionState:T?f:E,from:S,to:l,data:N}}function T(){return T=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},T.apply(this,arguments)}function h(t){var n=t.replace(/\//g,"-");return n.startsWith("-")?n.substring(1):n}var A=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],D=function(t){var e=t.pathname,o=t.className,i=!m.getState().from;return n(function(){return m.setState({suspendedRoute:e}),function(){m.setState({suspendedRoute:null})}},[]),/*#__PURE__*/S("div",{className:o+" "+o+"-"+h(e)+" "+o+"-"+(i?"appear":"enter")+"-suspended"})};function P(t){var n=t.children,e=t.pathname,o=t.className,r=t.timeout,u=t.detectAnimationEnd,s=t.detectTransitionEnd,d=function(t,n){if(null==t)return{};var e,o,i={},a=Object.keys(t);for(o=0;o<a.length;o++)n.indexOf(e=a[o])>=0||(i[e]=t[e]);return i}(t,A),f=i(null);/*#__PURE__*/return S(a,{fallback:/*#__PURE__*/S(D,{pathname:e,className:o}),children:/*#__PURE__*/S(E,T({nodeRef:f,addEndListener:function(t){if(f.current){var n=e===m.getState().to,o=e===m.getState().from;(n&&0===m.getState().onEnteringCount||o&&0===m.getState().onExitingCount)&&(u&&f.current.addEventListener("animationend",t,!1),s&&f.current.addEventListener("transitionend",t,!1)),n?m.setState({enterDone:t}):o&&m.setState({exitDone:t})}},timeout:r,classNames:o,appear:!0,unmountOnExit:!0},d,{onEnter:function(t){m.setState({transitionStateTo:t?l.APPEAR:l.ENTER}),d.onEnter&&d.onEnter()},onEntering:function(t){m.setState({transitionStateTo:t?l.APPEARING:l.ENTERING}),d.onEntering&&d.onEntering()},onEntered:function(t){m.setState({transitionStateTo:t?l.APPEARED:l.ENTERED}),d.onEntered&&d.onEntered()},onExit:function(){m.setState({transitionStateFrom:l.EXIT}),d.onExit&&d.onExit()},onExiting:function(){m.setState({transitionStateFrom:l.EXITING}),d.onExiting&&d.onExiting()},onExited:function(){m.setState({transitionStateFrom:l.EXITED}),d.onExited&&d.onExited()},children:/*#__PURE__*/S("div",{className:o+" "+o+"-"+h(e),ref:f,children:/*#__PURE__*/S(v.Provider,{value:e,children:n})})}),e)})}function C(t){var n=t.children,e=t.mode,o=void 0===e?"out-in":e,i=t.className,a=void 0===i?"page":i,d=t.timeout,f=t.detectAnimationEnd,E=void 0===f||f,p=t.detectTransitionEnd,v=void 0===p||p,N=t.pageName;function T(){/*#__PURE__*/return S(P,{pathname:N,className:a,timeout:d,detectAnimationEnd:E,detectTransitionEnd:v,children:n},N)}r(function(){m.getState().to=N,m.getState().transitionStateTo=l.SUSPENDED,m.getState().transitionStateFrom=l.SUSPENDED},[N]),x(function(){return m.getState().applyTransitionConfig(),function(){m.setState({from:N})}},[N]);var h=u(0),A=h[0],D=h[1];return x(function(){var t=m.getState().suspendedRoute;t&&N!==t&&D(A+1)},[N,A,D]),/*#__PURE__*/S(s,{children:"sync"===o?/*#__PURE__*/S(c,{component:null,appear:!0,enter:!0,exit:!0,children:T()}):function(t){/*#__PURE__*/return S(g,{mode:t,children:T()})}(o)},A)}function R(t){m.setState({transitionConfig:{data:t}})}export{v as PageContext,C as PageTransitions,l as TransitionState,R as setPageTransitionData,N as usePageTransition};
//# sourceMappingURL=pagetransitions.module.js.map
