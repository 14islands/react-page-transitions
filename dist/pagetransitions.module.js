import t from"zustand/vanilla";import n from"zustand";import{useLayoutEffect as e,useEffect as o,createContext as i,useContext as r,useRef as a,Suspense as u,useMemo as d,useState as s,Fragment as E}from"react";import{CSSTransition as c,TransitionGroup as f,SwitchTransition as l}from"react-transition-group";import{jsx as g}from"react/jsx-runtime";var S;!function(t){t.SUSPENDED="suspended",t.APPEAR="appear",t.APPEARING="appearing",t.APPEARED="appeared",t.EXIT="exit",t.EXITING="exiting",t.EXITED="exited",t.ENTER="enter",t.ENTERING="entering",t.ENTERED="entered"}(S||(S={}));var m=t(function(t){return{transitionStateTo:S.SUSPENDED,transitionStateFrom:S.SUSPENDED,transitionConfig:null,exitDone:function(){},enterDone:function(){},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:function(){return t(function(t){var n;return{data:null==(n=t.transitionConfig)?void 0:n.data,transitionConfig:null}})},suspendedRoute:null}}),p=n(m),x="undefined"!=typeof window?e:o,v=/*#__PURE__*/i("both");function N(t){var n=void 0===t?{}:t,e=n.onAppear,o=n.onAppearing,i=n.onAppeared,a=n.onEnter,u=n.onEntering,d=n.onEntered,s=n.onExit,E=n.onExiting,c=r(v),f=p(function(t){return t.transitionStateTo}),l=p(function(t){return t.transitionStateFrom}),g=p(function(t){return t.enterDone}),S=p(function(t){return t.exitDone}),N=p(function(t){return t.from}),T=p(function(t){return t.to}),h=p(function(t){return t.data}),D=c===m.getState().to,A=c===m.getState().from;return x(function(){return D&&u&&m.setState({onEnteringCount:m.getState().onEnteringCount+1}),function(){D&&u&&m.setState({onEnteringCount:m.getState().onEnteringCount-1})}},[D,u]),x(function(){return A&&E&&m.setState({onExitingCount:m.getState().onExitingCount+1}),function(){A&&E&&m.setState({onExitingCount:m.getState().onExitingCount-1})}},[A,E]),x(function(){D&&("appear"===f?null==e||e():"appearing"===f?null==o||o({done:g}):"appeared"===f?null==i||i():"enter"===f?null==a||a({from:m.getState().from}):"entering"===f?null==u||u({from:m.getState().from,to:m.getState().to,done:g,data:m.getState().data}):"entered"===f&&(null==d||d({from:m.getState().from})))},[f]),x(function(){A&&("exit"===l?null==s||s({to:m.getState().to}):"exiting"===l&&(null==E||E({from:m.getState().from,to:m.getState().to,done:S,data:m.getState().data})))},[l]),"both"===c?{transitionStateTo:f,transitionStateFrom:l,from:N,to:T,data:h}:{transitionState:D?f:l,from:N,to:T,data:h}}function T(){return T=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},T.apply(this,arguments)}function h(t){var n=t.replace(/\//g,"-");return n.startsWith("-")?n.substring(1):n}var D=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],A=function(t){var n=t.pathname,e=t.className,i=!m.getState().from;return o(function(){return m.setState({suspendedRoute:n}),function(){m.setState({suspendedRoute:null})}},[]),/*#__PURE__*/g("div",{className:e+" "+e+"-"+h(n)+" "+e+"-"+(i?"appear":"enter")+"-suspended"})};function P(t){var n=t.children,e=t.pathname,o=t.className,i=t.timeout,r=t.detectAnimationEnd,d=t.detectTransitionEnd,s=function(t,n){if(null==t)return{};var e,o,i={},r=Object.keys(t);for(o=0;o<r.length;o++)n.indexOf(e=r[o])>=0||(i[e]=t[e]);return i}(t,D),E=a(null);/*#__PURE__*/return g(u,{fallback:/*#__PURE__*/g(A,{pathname:e,className:o}),children:/*#__PURE__*/g(c,T({nodeRef:E,addEndListener:function(t){if(E.current){var n=e===m.getState().to,o=e===m.getState().from;(n&&0===m.getState().onEnteringCount||o&&0===m.getState().onExitingCount)&&(r&&E.current.addEventListener("animationend",t,!1),d&&E.current.addEventListener("transitionend",t,!1)),n?m.setState({enterDone:t}):o&&m.setState({exitDone:t})}},timeout:i,classNames:o,appear:!0,unmountOnExit:!0},s,{onEnter:function(t){m.setState({transitionStateTo:t?S.APPEAR:S.ENTER}),s.onEnter&&s.onEnter()},onEntering:function(t){m.setState({transitionStateTo:t?S.APPEARING:S.ENTERING}),s.onEntering&&s.onEntering()},onEntered:function(t){m.setState({transitionStateTo:t?S.APPEARED:S.ENTERED}),s.onEntered&&s.onEntered()},onExit:function(){m.setState({transitionStateFrom:S.EXIT}),s.onExit&&s.onExit()},onExiting:function(){m.setState({transitionStateFrom:S.EXITING}),s.onExiting&&s.onExiting()},onExited:function(){m.setState({transitionStateFrom:S.EXITED}),s.onExited&&s.onExited()},children:/*#__PURE__*/g("div",{className:o+" "+o+"-"+h(e),ref:E,children:/*#__PURE__*/g(v.Provider,{value:e,children:n})})}),e)})}function C(t){var n=t.children,e=t.mode,o=void 0===e?"out-in":e,i=t.className,r=void 0===i?"page":i,a=t.timeout,u=t.detectAnimationEnd,c=void 0===u||u,p=t.detectTransitionEnd,v=void 0===p||p,N=t.pageName;function T(){/*#__PURE__*/return g(P,{pathname:N,className:r,timeout:a,detectAnimationEnd:c,detectTransitionEnd:v,children:n},N)}d(function(){m.getState().to=N,m.getState().transitionStateTo=S.SUSPENDED,m.getState().transitionStateFrom=S.SUSPENDED},[N]),x(function(){return m.getState().applyTransitionConfig(),function(){m.setState({from:N})}},[N]);var h=s(0),D=h[0],A=h[1];return x(function(){var t=m.getState().suspendedRoute;t&&N!==t&&A(D+1)},[N,D,A]),/*#__PURE__*/g(E,{children:"sync"===o?/*#__PURE__*/g(f,{component:null,appear:!0,enter:!0,exit:!0,children:T()}):function(t){/*#__PURE__*/return g(l,{mode:t,children:T()})}(o)},D)}function R(t){m.setState({transitionConfig:{data:t}})}export{v as PageContext,C as PageTransitions,S as TransitionState,R as setPageTransitionData,N as usePageTransition};
//# sourceMappingURL=pagetransitions.module.js.map
