import t from"zustand/vanilla";import n from"zustand";import{createContext as e,useContext as o,useLayoutEffect as a,useRef as i,Suspense as r,useEffect as s,useMemo as E,useState as d,Fragment as u}from"react";import{CSSTransition as l,TransitionGroup as g,SwitchTransition as c}from"react-transition-group";import{jsx as S}from"react/jsx-runtime";var m;!function(t){t.SUSPENDED="suspended",t.APPEAR="appear",t.APPEARING="appearing",t.APPEARED="appeared",t.EXIT="exit",t.EXITING="exiting",t.EXITED="exited",t.ENTER="enter",t.ENTERING="entering",t.ENTERED="entered"}(m||(m={}));const p=t(t=>({transitionStateTo:m.SUSPENDED,transitionStateFrom:m.SUSPENDED,transitionConfig:null,exitDone:()=>{},enterDone:()=>{},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:()=>t(t=>{var n;return{data:null==(n=t.transitionConfig)?void 0:n.data,transitionConfig:null}}),suspendedRoute:null})),f=n(p),x=/*#__PURE__*/e("both");function N({onAppear:t,onAppearing:n,onAppeared:e,onEnter:i,onEntering:r,onEntered:s,onExit:E,onExiting:d}={}){const u=o(x),l=f(t=>t.transitionStateTo),g=f(t=>t.transitionStateFrom),c=f(t=>t.enterDone),S=f(t=>t.exitDone),m=f(t=>t.from),N=f(t=>t.to),T=f(t=>t.data),h=u===p.getState().to,D=u===p.getState().from;return a(()=>(h&&r&&p.setState({onEnteringCount:p.getState().onEnteringCount+1}),()=>{h&&r&&p.setState({onEnteringCount:p.getState().onEnteringCount-1})}),[h,r]),a(()=>(D&&d&&p.setState({onExitingCount:p.getState().onExitingCount+1}),()=>{D&&d&&p.setState({onExitingCount:p.getState().onExitingCount-1})}),[D,d]),a(function(){h&&("appear"===l?null==t||t():"appearing"===l?null==n||n({done:c}):"appeared"===l?null==e||e():"enter"===l?null==i||i({from:p.getState().from}):"entering"===l?null==r||r({from:p.getState().from,to:p.getState().to,done:c,data:p.getState().data}):"entered"===l&&(null==s||s({from:p.getState().from})))},[l]),a(function(){D&&("exit"===g?null==E||E({to:p.getState().to}):"exiting"===g&&(null==d||d({from:p.getState().from,to:p.getState().to,done:S,data:p.getState().data})))},[g]),"both"===u?{transitionStateTo:l,transitionStateFrom:g,from:m,to:N,data:T}:{transitionState:h?l:g,from:m,to:N,data:T}}function T(){return T=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},T.apply(this,arguments)}function h(t){const n=t.replace(/\//g,"-");return n.startsWith("-")?n.substring(1):n}const D=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],A=({pathname:t,className:n})=>{const e=!p.getState().from;return s(()=>(p.setState({suspendedRoute:t}),()=>{p.setState({suspendedRoute:null})}),[]),/*#__PURE__*/S("div",{className:`${n} ${n}-${h(t)} ${n}-${e?"appear":"enter"}-suspended`})};function P(t){let{children:n,pathname:e,className:o,timeout:a,detectAnimationEnd:s,detectTransitionEnd:E}=t,d=function(t,n){if(null==t)return{};var e,o,a={},i=Object.keys(t);for(o=0;o<i.length;o++)n.indexOf(e=i[o])>=0||(a[e]=t[e]);return a}(t,D);const u=i(null);/*#__PURE__*/return S(r,{fallback:/*#__PURE__*/S(A,{pathname:e,className:o}),children:/*#__PURE__*/S(l,T({nodeRef:u,addEndListener:t=>{if(!u.current)return;const n=e===p.getState().to,o=e===p.getState().from;(n&&0===p.getState().onEnteringCount||o&&0===p.getState().onExitingCount)&&(s&&u.current.addEventListener("animationend",t,!1),E&&u.current.addEventListener("transitionend",t,!1)),n?p.setState({enterDone:t}):o&&p.setState({exitDone:t})},timeout:a,classNames:o,appear:!0,unmountOnExit:!0},d,{onEnter:t=>{p.setState({transitionStateTo:t?m.APPEAR:m.ENTER}),d.onEnter&&d.onEnter()},onEntering:t=>{p.setState({transitionStateTo:t?m.APPEARING:m.ENTERING}),d.onEntering&&d.onEntering()},onEntered:t=>{p.setState({transitionStateTo:t?m.APPEARED:m.ENTERED}),d.onEntered&&d.onEntered()},onExit:()=>{p.setState({transitionStateFrom:m.EXIT}),d.onExit&&d.onExit()},onExiting:()=>{p.setState({transitionStateFrom:m.EXITING}),d.onExiting&&d.onExiting()},onExited:()=>{p.setState({transitionStateFrom:m.EXITED}),d.onExited&&d.onExited()},children:/*#__PURE__*/S("div",{className:`${o} ${o}-${h(e)}`,ref:u,children:/*#__PURE__*/S(x.Provider,{value:e,children:n})})}),e)})}function C({children:t,pageName:n,mode:e="out-in",className:o="page",timeout:i,detectAnimationEnd:r=!0,detectTransitionEnd:s=!0}){const l=n;function f(){/*#__PURE__*/return S(P,{pathname:l,className:o,timeout:i,detectAnimationEnd:r,detectTransitionEnd:s,children:t},l)}E(()=>{p.getState().to=l,p.getState().transitionStateTo=m.SUSPENDED,p.getState().transitionStateFrom=m.SUSPENDED},[l]),a(()=>(p.getState().applyTransitionConfig(),()=>{p.setState({from:l})}),[l]);const[x,N]=d(0);return a(()=>{const t=p.getState().suspendedRoute;t&&l!==t&&N(x+1)},[l,x,N]),/*#__PURE__*/S(u,{children:"sync"===e?/*#__PURE__*/S(g,{component:null,appear:!0,enter:!0,exit:!0,children:f()}):function(t){/*#__PURE__*/return S(c,{mode:t,children:f()})}(e)},x)}function R(t){p.setState({transitionConfig:{data:t}})}export{C as PageTransitions,m as TransitionState,R as setPageTransitionData,N as usePageTransition};
//# sourceMappingURL=pagetransitions.modern.js.map
