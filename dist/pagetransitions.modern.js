import{useLayoutEffect as t,useEffect as e,createContext as n,useContext as o,useRef as a,Suspense as i,useMemo as r,useState as s,Fragment as d}from"react";import E from"zustand/vanilla";import u from"zustand";import{CSSTransition as g,TransitionGroup as S,SwitchTransition as l}from"react-transition-group";import{jsx as m}from"react/jsx-runtime";var c;!function(t){t.SUSPENDED="suspended",t.APPEAR="appear",t.APPEARING="appearing",t.APPEARED="appeared",t.EXIT="exit",t.EXITING="exiting",t.EXITED="exited",t.ENTER="enter",t.ENTERING="entering",t.ENTERED="entered"}(c||(c={}));const p=E(t=>({transitionStateTo:c.SUSPENDED,transitionStateFrom:c.SUSPENDED,transitionConfig:null,exitDone:()=>{},enterDone:()=>{},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:()=>t(t=>{var e;return{data:null==(e=t.transitionConfig)?void 0:e.data,transitionConfig:null}}),suspendedRoute:null})),f=u(p),x="undefined"!=typeof window?t:e,N=/*#__PURE__*/n("both");function T({onEnter:t,onEntering:n,onEntered:a,onExit:i,onExiting:r}={}){const s=o(N),d=f(t=>t.transitionStateTo),E=f(t=>t.transitionStateFrom),u=f(t=>t.enterDone),g=f(t=>t.exitDone),S=f(t=>t.from),l=f(t=>t.to),m=f(t=>t.data),c=s===p.getState().to,T=s===p.getState().from;return x(()=>(c&&n&&p.setState({onEnteringCount:p.getState().onEnteringCount+1}),()=>{c&&n&&p.setState({onEnteringCount:p.getState().onEnteringCount-1})}),[c,n]),x(()=>(T&&r&&p.setState({onExitingCount:p.getState().onExitingCount+1}),()=>{T&&r&&p.setState({onExitingCount:p.getState().onExitingCount-1})}),[T,r]),e(function(){c&&("appear"===d?null==t||t({isAppearing:!0,from:p.getState().from,to:p.getState().to}):"appearing"===d?null==n||n({isAppearing:!0,done:u,from:p.getState().from,to:p.getState().to}):"appeared"===d?null==a||a({isAppearing:!0,from:p.getState().from,to:p.getState().to}):"enter"===d?null==t||t({isAppearing:!1,from:p.getState().from,to:p.getState().to}):"entering"===d?null==n||n({isAppearing:!1,from:p.getState().from,to:p.getState().to,done:u,data:p.getState().data}):"entered"===d&&(null==a||a({isAppearing:!1,from:p.getState().from,to:p.getState().to})))},[d]),x(function(){T&&("exit"===E?null==i||i({to:p.getState().to}):"exiting"===E&&(null==r||r({from:p.getState().from,to:p.getState().to,done:g,data:p.getState().data})))},[E]),"both"===s?{transitionStateTo:d,transitionStateFrom:E,from:S,to:l,data:m}:{transitionState:c?d:E,from:S,to:l,data:m}}function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},h.apply(this,arguments)}function A(t){const e=t.replace(/\//g,"-");return e.startsWith("-")?e.substring(1):e}const D=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],P=({pathname:t,className:n})=>{const o=!p.getState().from;return e(()=>(p.setState({suspendedRoute:t}),()=>{p.setState({suspendedRoute:null})}),[]),/*#__PURE__*/m("div",{className:`${n} ${n}-${A(t)} ${n}-${o?"appear":"enter"}-suspended`})};function C(t){let{children:e,pathname:n,className:o,timeout:r,detectAnimationEnd:s,detectTransitionEnd:d}=t,E=function(t,e){if(null==t)return{};var n,o,a={},i=Object.keys(t);for(o=0;o<i.length;o++)e.indexOf(n=i[o])>=0||(a[n]=t[n]);return a}(t,D);const u=a(null);/*#__PURE__*/return m(i,{fallback:/*#__PURE__*/m(P,{pathname:n,className:o}),children:/*#__PURE__*/m(g,h({nodeRef:u,addEndListener:t=>{if(!u.current)return;const e=n===p.getState().to,o=n===p.getState().from;(e&&0===p.getState().onEnteringCount||o&&0===p.getState().onExitingCount)&&(s&&u.current.addEventListener("animationend",t,!1),d&&u.current.addEventListener("transitionend",t,!1)),e?p.setState({enterDone:t}):o&&p.setState({exitDone:t})},timeout:r,classNames:o,appear:!0,unmountOnExit:!0},E,{onEnter:t=>{p.setState({transitionStateTo:t?c.APPEAR:c.ENTER}),E.onEnter&&E.onEnter()},onEntering:t=>{p.setState({transitionStateTo:t?c.APPEARING:c.ENTERING}),E.onEntering&&E.onEntering()},onEntered:t=>{p.setState({transitionStateTo:t?c.APPEARED:c.ENTERED}),E.onEntered&&E.onEntered()},onExit:()=>{p.setState({transitionStateFrom:c.EXIT}),E.onExit&&E.onExit()},onExiting:()=>{p.setState({transitionStateFrom:c.EXITING}),E.onExiting&&E.onExiting()},onExited:()=>{p.setState({transitionStateFrom:c.EXITED}),E.onExited&&E.onExited()},children:/*#__PURE__*/m("div",{className:`${o} ${o}-${A(n)}`,ref:u,children:/*#__PURE__*/m(N.Provider,{value:n,children:e})})}),n)})}function R({children:t,pageName:e,mode:n="out-in",className:o="page",timeout:a,detectAnimationEnd:i=!0,detectTransitionEnd:E=!0}){const u=e;function g(){/*#__PURE__*/return m(C,{pathname:u,className:o,timeout:a,detectAnimationEnd:i,detectTransitionEnd:E,children:t},u)}r(()=>{p.getState().to=u,p.getState().transitionStateTo=c.SUSPENDED,p.getState().transitionStateFrom=c.SUSPENDED},[u]),x(()=>(p.getState().applyTransitionConfig(),()=>{p.setState({from:u})}),[u]);const[f,N]=s(0);return x(()=>{const t=p.getState().suspendedRoute;t&&u!==t&&N(f+1)},[u,f,N]),/*#__PURE__*/m(d,{children:"sync"===n?/*#__PURE__*/m(S,{component:null,appear:!0,enter:!0,exit:!0,children:g()}):function(t){/*#__PURE__*/return m(l,{mode:t,children:g()})}(n)},f)}function v(t){p.setState({transitionConfig:{data:t}})}export{N as PageContext,R as PageTransitions,c as TransitionState,v as setPageTransitionData,T as usePageTransition};
//# sourceMappingURL=pagetransitions.modern.js.map
