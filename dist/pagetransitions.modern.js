import t from"zustand/vanilla";import n from"zustand";import{useLayoutEffect as e,useEffect as o,createContext as a,useContext as i,useRef as r,Suspense as s,useMemo as d,useState as E,Fragment as u}from"react";import{CSSTransition as l,TransitionGroup as c,SwitchTransition as g}from"react-transition-group";import{jsx as S}from"react/jsx-runtime";var m;!function(t){t.SUSPENDED="suspended",t.APPEAR="appear",t.APPEARING="appearing",t.APPEARED="appeared",t.EXIT="exit",t.EXITING="exiting",t.EXITED="exited",t.ENTER="enter",t.ENTERING="entering",t.ENTERED="entered"}(m||(m={}));const p=t(t=>({transitionStateTo:m.SUSPENDED,transitionStateFrom:m.SUSPENDED,transitionConfig:null,exitDone:()=>{},enterDone:()=>{},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:()=>t(t=>{var n;return{data:null==(n=t.transitionConfig)?void 0:n.data,transitionConfig:null}}),suspendedRoute:null})),f=n(p),x="undefined"!=typeof window?e:o,N=/*#__PURE__*/a("both");function T({onAppear:t,onAppearing:n,onAppeared:e,onEnter:o,onEntering:a,onEntered:r,onExit:s,onExiting:d}={}){const E=i(N),u=f(t=>t.transitionStateTo),l=f(t=>t.transitionStateFrom),c=f(t=>t.enterDone),g=f(t=>t.exitDone),S=f(t=>t.from),m=f(t=>t.to),T=f(t=>t.data),h=E===p.getState().to,D=E===p.getState().from;return x(()=>(h&&a&&p.setState({onEnteringCount:p.getState().onEnteringCount+1}),()=>{h&&a&&p.setState({onEnteringCount:p.getState().onEnteringCount-1})}),[h,a]),x(()=>(D&&d&&p.setState({onExitingCount:p.getState().onExitingCount+1}),()=>{D&&d&&p.setState({onExitingCount:p.getState().onExitingCount-1})}),[D,d]),x(function(){h&&("appear"===u?null==t||t():"appearing"===u?null==n||n({done:c}):"appeared"===u?null==e||e():"enter"===u?null==o||o({from:p.getState().from}):"entering"===u?null==a||a({from:p.getState().from,to:p.getState().to,done:c,data:p.getState().data}):"entered"===u&&(null==r||r({from:p.getState().from})))},[u]),x(function(){D&&("exit"===l?null==s||s({to:p.getState().to}):"exiting"===l&&(null==d||d({from:p.getState().from,to:p.getState().to,done:g,data:p.getState().data})))},[l]),"both"===E?{transitionStateTo:u,transitionStateFrom:l,from:S,to:m,data:T}:{transitionState:h?u:l,from:S,to:m,data:T}}function h(){return h=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},h.apply(this,arguments)}function D(t){const n=t.replace(/\//g,"-");return n.startsWith("-")?n.substring(1):n}const A=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],P=({pathname:t,className:n})=>{const e=!p.getState().from;return o(()=>(p.setState({suspendedRoute:t}),()=>{p.setState({suspendedRoute:null})}),[]),/*#__PURE__*/S("div",{className:`${n} ${n}-${D(t)} ${n}-${e?"appear":"enter"}-suspended`})};function C(t){let{children:n,pathname:e,className:o,timeout:a,detectAnimationEnd:i,detectTransitionEnd:d}=t,E=function(t,n){if(null==t)return{};var e,o,a={},i=Object.keys(t);for(o=0;o<i.length;o++)n.indexOf(e=i[o])>=0||(a[e]=t[e]);return a}(t,A);const u=r(null);/*#__PURE__*/return S(s,{fallback:/*#__PURE__*/S(P,{pathname:e,className:o}),children:/*#__PURE__*/S(l,h({nodeRef:u,addEndListener:t=>{if(!u.current)return;const n=e===p.getState().to,o=e===p.getState().from;(n&&0===p.getState().onEnteringCount||o&&0===p.getState().onExitingCount)&&(i&&u.current.addEventListener("animationend",t,!1),d&&u.current.addEventListener("transitionend",t,!1)),n?p.setState({enterDone:t}):o&&p.setState({exitDone:t})},timeout:a,classNames:o,appear:!0,unmountOnExit:!0},E,{onEnter:t=>{p.setState({transitionStateTo:t?m.APPEAR:m.ENTER}),E.onEnter&&E.onEnter()},onEntering:t=>{p.setState({transitionStateTo:t?m.APPEARING:m.ENTERING}),E.onEntering&&E.onEntering()},onEntered:t=>{p.setState({transitionStateTo:t?m.APPEARED:m.ENTERED}),E.onEntered&&E.onEntered()},onExit:()=>{p.setState({transitionStateFrom:m.EXIT}),E.onExit&&E.onExit()},onExiting:()=>{p.setState({transitionStateFrom:m.EXITING}),E.onExiting&&E.onExiting()},onExited:()=>{p.setState({transitionStateFrom:m.EXITED}),E.onExited&&E.onExited()},children:/*#__PURE__*/S("div",{className:`${o} ${o}-${D(e)}`,ref:u,children:/*#__PURE__*/S(N.Provider,{value:e,children:n})})}),e)})}function R({children:t,pageName:n,mode:e="out-in",className:o="page",timeout:a,detectAnimationEnd:i=!0,detectTransitionEnd:r=!0}){const s=n;function l(){/*#__PURE__*/return S(C,{pathname:s,className:o,timeout:a,detectAnimationEnd:i,detectTransitionEnd:r,children:t},s)}d(()=>{p.getState().to=s,p.getState().transitionStateTo=m.SUSPENDED,p.getState().transitionStateFrom=m.SUSPENDED},[s]),x(()=>(p.getState().applyTransitionConfig(),()=>{p.setState({from:s})}),[s]);const[f,N]=E(0);return x(()=>{const t=p.getState().suspendedRoute;t&&s!==t&&N(f+1)},[s,f,N]),/*#__PURE__*/S(u,{children:"sync"===e?/*#__PURE__*/S(c,{component:null,appear:!0,enter:!0,exit:!0,children:l()}):function(t){/*#__PURE__*/return S(g,{mode:t,children:l()})}(e)},f)}function v(t){p.setState({transitionConfig:{data:t}})}export{N as PageContext,R as PageTransitions,m as TransitionState,v as setPageTransitionData,T as usePageTransition};
//# sourceMappingURL=pagetransitions.modern.js.map
